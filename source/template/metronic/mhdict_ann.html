{extends 'common_main.html'}
{block subtitle}{lang nav/ann}{/block}
{block pagestyle}
<link rel="stylesheet" type="text/css" href="assets/global/plugins/select2/select2.css" />
<link rel="stylesheet" type="text/css" href="assets/global/plugins/bootstrap-datetimepicker/css/datetimepicker.css"/>
<link rel="stylesheet" type="text/css" href="assets/global/plugins/datatables/plugins/bootstrap/dataTables.bootstrap.css" />
<style type="text/css" media="screen">
#anns tr, #anns td {
	vertical-align: middle;
}
#anns tr > td:nth-child(1) {
	text-align: center;
}
</style>
{/block}
{block pageplugins}
	<script type="text/javascript" src="assets/global/plugins/datatables/media/js/jquery.dataTables.min.js"></script>
	<script type="text/javascript" src="assets/global/plugins/datatables/plugins/bootstrap/dataTables.bootstrap.js"></script>
	<script type="text/javascript" src="assets/global/plugins/select2/select2.min.js"></script>
	<script type="text/javascript" src="assets/global/plugins/select2/select2_locale_zh-CN.js"></script>
	<script type="text/javascript" src="{static 'assets/admin/pages/scripts/mhdict.js'}"></script>
{/block}
{block pagejs}
	<script type="text/javascript">
		$(document).ready(function() {
			Metronic.init();
			Layout.init();
			//IdleTimeout.init();
			Mhdict.initann();
		});
	</script>
{/block}
{block pgcontent}
			<div id="alert-modal" class="modal fade" tabindex="-1" data-backdrop="static">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal" aria-hidden="true"></button>
					<h4 class="modal-title">提示信息</h4>
				</div>
				<div class="modal-body"></div>
				<div class="modal-footer">
					<button type="button" data-dismiss="modal" class="btn blue">确定</button>
				</div>
			</div>
			<div id="anndetail" class="modal fade modal-scroll" tabindex="-1" data-backdrop="static" data-keyboard="false" data-width="760">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal" aria-hidden="true"></button>
					<h4 class="modal-title">公告详情</h4>
				</div>
				<div class="modal-body">
					<form action="{U 'mhdict/ann?inajax=1'}" class="form-horizontal" method="post">
						<input type="hidden" name="type" value="" />
						<input type="hidden" name="id" value="" />
						<div class="form-group">
							<label class="control-label col-xs-12"><p class="text-left">审核消息</p></label>
							<div class="col-xs-12"><textarea class="form-control" name="verifytext" rows="6"></textarea></div>
						</div>
					</form>
				</div>
				<div class="modal-footer">
					<button type="button" data-dismiss="modal" class="btn btn-default">取消</button>
					<button type="button" class="btn blue">提交</button>
				</div>
			</div>
			<div class="portlet box blue-hoki">
				<div class="portlet-title">
					<div class="caption"><i class="fa fa-user"></i> 站点公告</div>
				</div>
				<div class="portlet-body">
					<div class="table-toolbar">
						<button id="addann-button" class="btn green"><i class="fa fa-plus"></i> 添加公告</button>
					</div>
					<form action="{U mhdict/ann}" method="post" accept-charset="utf-8">
						<div class="table-scrollable">
							<table class="table table-striped table-bordered table-hover" id="anns">
								<thead><tr>
									<th scope="col" style="width:62px !important"><label><input type="checkbox" class="group-checkable" />删?</label></th>
									<th scope="col" style="width:80px !important">显示顺序</th>
									<th scope="col">作者</th>
									<th scope="col" style="min-width:180px !important">标题</th>
									<th scope="col">内容</th>
									<th scope="col" style="width:5.4em !important">公告类型</th>
									<th scope="col" style="width:9.7em !important">起始时间</th>
									<th scope="col" style="width:9.7em !important">终止时间</th>
									<th scope="col">可视范围</th>
									<th scope="col">操作选项</th>
								</tr></thead>
								<tbody>
									{foreach $anns as $ann}
									<tr class="odd gradeX">
										<td><input type="checkbox" class="checkboxes" name="id[]" value="{$ann.id}" /></td>
										<td><input type="number" class="form-control" name="displayorder[{$ann.id}]" value="{$ann.displayorder}" /></td>
										<td>{$ann.author}</td>
										<td>{$ann.subject}</td>
										<td>{if $ann.type}<a href="{$ann.message}" target="_blank">{/if}{$ann.message}{if $ann.type}</a>{/if}</td>
										<td>{if $ann.type}网址链接{else}文字公告{/if}</td>
										<td>{if $ann.starttime}{dgmdate($ann.starttime)}{else}-{/if}</td>
										<td>{if $ann.endtime}{dgmdate($ann.endtime)}{else}-{/if}</td>
										<td data-academy="{$ann.academy}">{if $ann.academy}{$academies[$ann.academy].name}{else}全局{/if}</td>
										<td><a href="javascript:;" class="btn btn-xs default blue-stripe">编辑</a></td>
									</tr>
									{/foreach}
								</tbody>
							</table>
						</div>
						<button type="submit" class="btn blue"><i class="fa fa-check"></i> 提交</button>
					</form>
				</div>
			</div>
{/block}